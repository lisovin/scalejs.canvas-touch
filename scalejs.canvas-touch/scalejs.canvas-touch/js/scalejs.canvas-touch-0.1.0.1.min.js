define("scalejs.canvas-touch/canvas-touch",["hammer"],function(e){return function(t,a,n){function s(){f=window.getComputedStyle(t),x=Math.max(parseInt(f.width,10),1),m=Math.max(parseInt(f.height,10),1),h.width=x,h.height=m,c.style.width=x,c.style.height=m,c.setAttribute("width",x),c.setAttribute("height",m)}function g(e){function g(e,t){var a=e.pageX-t.pageX,n=e.pageY-t.pageY;return Math.sqrt(a*a+n*n)}if(e.gesture){e.gesture.preventDefault();var p,r,o,u,f,X,I,T,b,C,j,A,R=e.gesture,E=[];for(A=0;A<R.touches.length;A+=1)E[A]={pageX:R.touches[A].pageX,pageY:R.touches[A].pageY};"touch"===e.type?(y=E,d=2===E.length?{x:(E[0].pageX-E[1].pageX)/2+E[1].pageX,y:(E[0].pageY-E[1].pageY)/2+E[1].pageY}:{x:E[0].pageX,y:E[0].pageY},s(),l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,x,m),l.drawImage(t,0,0),c.style.display="",t.style.display="none",a(0,0,0,1),i.clearRect(0,0,x,m),i.drawImage(t,0,0)):"release"===e.type?(y=void 0,d=void 0,n(Y,v,w,M),t.style.display="",c.style.display="none"):(void 0===y&&(y=E),1===E.length?(1!==y.length&&(y=E,d=void 0),p={x:E[0].pageX,y:E[0].pageY},Y+=E[0].pageX-y[0].pageX,v+=E[0].pageY-y[0].pageY):2===E.length&&(2!==y.length&&(y=E,d=void 0),p={x:(E[0].pageX-E[1].pageX)/2+E[1].pageX,y:(E[0].pageY-E[1].pageY)/2+E[1].pageY},void 0===d&&(d=p),r=g(E[0],E[1])/g(y[0],y[1]),o=Math.atan2(y[0].pageX-d.x,y[0].pageY-d.y)-Math.atan2(E[0].pageX-p.x,E[0].pageY-p.y),C=Math.sin(o),j=Math.cos(o),o*=180/Math.PI,M*=r,w+=o,u=e.currentTarget.getBoundingClientRect(),f={pageX:p.x,pageY:p.y},f.pageX-=u.left,f.pageY-=u.top,X={x:Y-f.pageX,y:v-f.pageY},I={x:X.x*j-X.y*C+f.pageX,y:X.x*C+X.y*j+f.pageY},T={x:r*(I.x-f.pageX)+f.pageX-Y,y:r*(I.y-f.pageY)+f.pageY-v},b={x:T.x+(p.x-d.x),y:T.y+(p.y-d.y)},Y+=b.x,v+=b.y),l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,x,m),l.translate(Y,v),l.scale(M,M),l.rotate(w/180*Math.PI),l.translate(-Y,-v),l.drawImage(h,Y,v),l.setTransform(1,0,0,1,0,0),y=E,d=p)}}function p(){return{left:Y,top:v,rotate:w,scale:M}}function r(e,t,a,n){v=e,Y=t,w=a,M=n}function o(){Y=0,v=0,w=0,M=1}var h,i,c,l,u,y,d,f=window.getComputedStyle(t),x=Math.max(parseInt(f.width,10),1),m=Math.max(parseInt(f.height,10),1),X=t.parentNode,Y=0,v=0,w=0,M=1;return h=document.createElement("canvas"),h.width=x,h.height=m,i=h.getContext("2d"),c=document.createElement("canvas"),c.style.position="absolute",c.style.left=0,c.style.top=0,c.style.display="none",c.style.width=x,c.style.height=m,c.setAttribute("width",x),c.setAttribute("height",m),l=c.getContext("2d"),X.append(c),e.plugins.showTouches(),e.plugins.fakeMultitouch(),u=e(X,{prevent_default:!0}),u.on("touch drag swipe pinch rotate transform release",g),{getTransform:p,setTransform:r,resetTransform:o}}}),define("scalejs.canvas-touch",["scalejs!core","./scalejs.canvas-touch/canvas-touch"],function(e,t){e.registerExtension({canvas:{touch:t}})});